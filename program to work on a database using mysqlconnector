def insert():
    cur.execute("select column_name from information_schema.columns where table_name='{}'".format(tb))
    print("Columns available in the table")
    data=cur.fetchall()
    for i in range(len(data)):
        print("\t",i+1,".  ",data[i][0],sep="")
    print("Enter the values in corresponding datatype seperated by comma in the format",data,end=" ")
    st=input()
    cur.execute("Insert into job values({})".format(st))
    mycon.commit()
    print("Record successfully inserted")
    cur.execute("Select * from {}".format(tb))
    data=cur.fetchall()
    print()
    print("Updated Table given below")
    for i in data:
        print(i)
    
    
def display():
    print("To display all records enter ALL otherwise")
    n=input("Enter the number of records to display").upper()
    cur.execute("Select * from {}".format(tb))
    if n=="ALL":
        print(cur.fetchall())
    else:
        print(cur.fetchmany(int(n)))
    
    
def search():
    cur.execute("select column_name from information_schema.columns where table_name='{}'".format(tb))
    print("Columns available in the table")
    data=cur.fetchall()
    for i in range(len(data)):
        print("\t",i+1,".  ",data[i][0],sep="")
    w=input("Enter the column name using which you want to find the record")
    print("Enter the value of that",w,end=" ")
    wi=input()
    cur.execute("select * from {} where {}='{}'".format(tb,w,wi))
    print(cur.fetchall())
    
    
def modify():
    cur.execute("select column_name from information_schema.columns where table_name='{}'".format(tb))
    print("Fields available in the table")
    data=cur.fetchall()
    for i in range(len(data)):
        print("\t",i+1,".  ",data[i][0],sep="")
    ch=input("Enter the field name to modify")
    cur.execute("select {} from {}".format(ch,tb))
    print("Availabes values in the given field")
    for i in cur:
        print("\t\t\t",i[0])
    cur.execute("select * from {}".format(tb))
    print("All records given below")
    for i in cur:
        print(i)
    cur.execute("select column_name from information_schema.columns where table_name='{}'".format(tb))
    print("Columns available in the table")
    data=cur.fetchall()
    for i in range(len(data)):
        print("\t",i+1,".  ",data[i][0],sep="")
    w=input("Enter the column name using which you want to find the record")
    print("Enter the value of that",w,end=" ")
    wi=input()
    print("Enter the new value of",ch,end="")
    nw=input()
    cur.execute("update {} set {}='{}' where {}='{}'".format(tb,ch,nw,w,wi))
    mycon.commit()
    print("Record sucessfully modified")
    cur.execute("Select * from {}".format(tb))
    data=cur.fetchall()
    print()
    print("Updated Table given below")
    for i in data:
        print(i)
    
    
def delete():
    cur.execute("select column_name from information_schema.columns where table_name='{}'".format(tb))
    print("Columns available in the table")
    data=cur.fetchall()
    for i in range(len(data)):
        print("\t",i+1,".  ",data[i][0],sep="")
    w=input("Enter the column name using which you want to find the record")
    print("Enter the value of that",w,end=" ")
    wi=input()
    cur.execute("Delete from {} where {}='{}'".format(tb,w,wi))
    mycon.commit()
    print("Record successfully deleted")
    cur.execute("Select * from {}".format(tb))
    data=cur.fetchall()
    print()
    print("Updated Table given below")
    for i in data:
        print(i)

    
import mysql.connector
db=input("Enter the name of database to work in this session")
mycon=mysql.connector.connect(host="localhost",user="root",database=db,passwd="")
if mycon.is_connected():
    print("Successfully Connected to Database")
else:
    print("Connection to Database failed")
tb=input("Enter the table to work in this session")
cur=mycon.cursor()



while True:
    print()
    print("What do you want to do with your table?")
    print("\t\t1. Insert Record")
    print("\t\t2. Display Record")
    print("\t\t3. Search Record")
    print("\t\t4. Modify Record")
    print("\t\t5. Delete Recod")
    print("\t\t6. Exit")
    print()
    ch=int(input("Enter the choice"))
    if ch==1:
        insert()
    elif ch==2:
        display()
    elif ch==3:
        search()
    elif ch==4:
        modify()
    elif ch==5:
        delete()
    elif ch==6:
         mycon.close()
         break
    else:
        print("Invalid choice entered")
print("Thanks for using our services")
